{
    "contents" : "\\name{cfderiv}\n\\alias{cfderiv}\n%- Also NEED an '\\alias' for EACH other topic documented here.\n\\title{\nAuto-constructing Frechet derivative of D-criterion based on general equivalence theorem \n%Auto-constructing derivative function of D-criterion\n}\n\\description{\n\nAuto-constructs Frechet derivative of D-criterion at \\eqn{M(\\xi, \\beta)} and in direction \\eqn{M(\\xi_x, \\beta)} where \\eqn{M} is Fisher information matrix, \\eqn{\\beta} is vector of parameters, \\eqn{\\xi} is the interested design and \\eqn{\\xi_x} is a uniqe design which only has point \\eqn{x}. The constructed Frechet derivative is an \\R function with argument \\eqn{x}.\n\n%Auto-constructs derivative function of D-criterion based on general equivalence theorem (Kiefer, 1974).  \n\n%models that their response variables are independent and can be writen as a function of explanatory variables and parameters. This function must be continuous and differentiable with respect to the models parameters. In addition, distribution of response variable must belong to the Natural exponential family. See 'Note' for more details. \n}\n\\usage{\ncfderiv(ymean, yvar, param, points, weights)\n}\n%- maybe also 'usage' for other objects documented here.\n\\arguments{\n\\item{ymean}{ a character string, \nformula of \\eqn{E(y)} with specific satndard: characters \\code{b1}, \\code{b2}, \\code{b3}, \\dots symbolize model parameters and \\code{x1}, \\code{x2}, \\code{x3}, \\dots symbolize explanatory variables. See 'Examples'.\n}\n  \\item{yvar}{\na character string, formula of \\eqn{Var(y)} with specific standard as \\code{ymean}. See 'Details' and 'Examples'.\n}\n  \\item{param}{\na vector of values of parameters which must correspond to \\code{b1}, \\code{b2}, \\code{b3}, \\dots  in \\code{ymean}.\n%, its length must be equal to the number of b1, b2, ... in 'ymean'.\n}\n  \\item{points}{\na vector of points which belong to design \\eqn{\\xi} . See 'Details'.\n}\n  \\item{weights}{\na vector of \\eqn{\\xi} points weights. The sum of weights should be \\eqn{1}; otherwise they will be normalized.\n}\n}\n\\details{\nIf response variables have the same constant variance, for example \\eqn{\\sigma^2}, then \\code{yvar} must be \\eqn{1}.  \n\n\nConsider design \\eqn{\\xi} with \\eqn{n} \\eqn{m}-dimensional points. Then, the vector of \\eqn{\\xi} points is \n\\deqn{(x_1, x_2, \\ldots, x_i, \\ldots, x_n),}\nwhere \\eqn{x_i = (x_{i1}, x_{i2}, \\ldots, x_{im})}. Hence the length of vector points is \\eqn{mn}.\n}\n\\value{\n%%  ~Describe the value returned\n%%  If it is a LIST, use\n%\\item{comp1 }{Description of 'comp1'}\n\\item{fderiv}{ a function in which its argument is a vector \\eqn{x}, an \\eqn{m}-dimentional design point, and its output is the value of Frechet derivative at \\eqn{M(\\xi, \\beta)} and in direction \\eqn{M(\\xi_x, \\beta)}.\n}\n%% ...\n}\n\\references{\nMasoudi, E., Sarmad, M. and Talebi, H. 2012, An Almost General Code in R to Find Optimal Design, In Proceedings of the 1st ISM International Statistical Conference 2012, 292-297.\n\nKiefer, J. C.  1974, General equivalence theory for optimum designs (approximate theory), Ann. Statist., 2, 849-879.7.\n}\n\\author{\nEhsan Masoudi, Majid Sarmad and Hooshang Talebi\n}\n\\note{\nA design \\eqn{\\xi} is D-optimal if and only if Frechet derivative at \\eqn{M(\\xi, \\beta)} and in direction \\eqn{M(\\xi_x, \\beta)}is greater than or equal to \\eqn{0} on the design space. The equality must be achieved just at \\eqn{\\xi} points. Here, \\eqn{x} is an arbitrary point on design space.\n\nThis function is applicable for models that can be written as \\eqn{E(Y_i) = f(x_i,\\beta)}\nwhere \\eqn{y_i} is the \\eqn{ith} response variable, \\eqn{x_i} is the observation vector of the \\eqn{ith} explanatory variables, \\eqn{\\beta} is the vector of parameters and \\eqn{f} is a continuous and differentiable function with respect to \\eqn{\\beta}.\nIn addition, response variables must be independent with distributions that belong to the Natural exponential family. Logistic,Poisson, Negative Binomial, Exponential,  Richards, Weibull, Log-linear, Inverse Quadratic and Michaelis-Menten are examples of these models.\n}\n\n\n\\examples{\n## Logistic dose response model:\nymean <- \"(1/(exp(-b2 * (x1 - b1)) + 1))\"\nyvar <- \"(1/(exp(-b2 * (x1 - b1)) + 1))*(1 - (1/(exp(-b2 * (x1 - b1)) + 1)))\"\nfunc <- cfderiv(ymean, yvar, param =  c(.9, .8), points = c(-1.029256, 2.829256),\n weights = c(.5, .5))\n## plot func on the design interval to verify the optimality of the given design\nx <- seq(-5, 5, by = .1)\nplot(x, -func(x), type = \"l\")\n\n## Inverse Quadratic model\nymean <- \"x1/(b1 + b2 * x1 + b3 * (x1)^2)\"\nyvar <- \"1\"\nfunc <- cfderiv(ymean, yvar, param = c(17, 15, 9), points = c(0.33, 1.37, 5.62), \nweights = rep(.33, 3))\n## plot func on the design interval to verify the optimality of the given design\nx <- seq(0, 15, by = .1)\nplot(x, -func(x), type = \"l\")\n\n#####################################################################\n## In the following, ymean and yvar for some famous models are given:\n\n## Inverse Quadratic model (another form):\nymean <- \"(b1 * x1)/(b2 + x1 + b3 * (x1)^2)\"\nyvar <- \"1\"\n\n## Logistic dose response model:\nymean <- \"(1/(exp(-b2 * (x1 - b1)) + 1))\"\nyvar <- \"(1/(exp(-b2 * (x1 - b1)) + 1)) * (1 - (1/(exp(-b2 * (x1 - b1)) + 1)))\"\n\n## Logistic model:\nymean <- \"1/(exp(-b1 - b2 * x1) + 1)\"\nyvar <- \"(1/(exp(-b1 - b2 * x1) + 1)) * (1 - (1/(exp(-b1 - b2 * x1) + 1)))\"\n\n## Poisson model:\nymean <- yvar <-  \"exp(b1 + b2 * x1)\"\n\n## Poisson dose response model:\nymean <- yvar <- \"b1 * exp(-b2 * x1)\"\n\n## Weibull model:\nymean <- \"b1 - b2 * exp(-b3 * x1^b4)\"\nyvar <- \"1\"\n\n## Richards model:\nymean <- \"b1/(1 + b2 * exp(-b3 * x1))^b4\"\nyvar <- \"1\"\n\n## Michaelis-Menten model:\nymean <- \"(b1 * x1)/(1 + b2 * x1)\"\nyvar <- \"1\"\n#\nymean <- \"(b1 * x1)/(b2 + x1)\"\nyvar <= \"1\"\n#\nymean <- \"x1/(b1 + b2 * x1)\"\nyvar <- \"1\"\n\n## log-linear model:\nymean <- \"b1 + b2 * log(x1 + b3)\"\nyvar <- \"1\"\n\n## Exponential model:\nymean <- \"b1 + b2 * exp(x1/b3)\"\nyvar <- \"1\"\n\n## Emax model:\nymean  <- \"b1 + (b2 * x1)/(x1 + b3)\"\nyvar <- \"1\"\n\n## Negative binomial model Y ~ NB(E(Y), theta) where E(Y) = b1*exp(-b2*x1):\ntheta = 5\nymean <- \"b1 * exp(-b2 * x1)\"\nyvar <- paste (\"b1 * exp(-b2 * x1) * (1 + (1/\", theta, \") * b1 * exp(-b2 * x1))\" , sep = \"\")\n\n## Linear regression model:\nymean <- \"b1 + b2 * x1 + b3 * x2 + b4 * x1 * x2\"\nyvar = \"1\"\n}\n% Add one or more standard keywords, see file 'KEYWORDS' in the\n% R documentation directory.\n\\keyword{optimal design}\n\\keyword{equivalence theorem}% __ONLY ONE__ keyword per line\n",
    "created" : 1361822811620.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1349324111",
    "id" : "E50BC0DD",
    "lastKnownWriteTime" : 1361896242,
    "path" : "C:/Users/Ehsan/Desktop/PACKAGE/pack5/LDOD/man/cfderiv.Rd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_doc"
}